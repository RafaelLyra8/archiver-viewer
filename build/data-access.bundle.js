!function(t){function e(e){for(var r,a,u=e[0],s=e[1],l=e[2],f=0,h=[];f<u.length;f++)a=u[f],o[a]&&h.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);for(c&&c(e);h.length;)h.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,u=1;u<n.length;u++){var s=n[u];0!==o[s]&&(r=!1)}r&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},o={3:0},i=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var c=s;i.push([18,0]),n()}({18:function(t,e,n){"use strict";n.r(e);var r=n(21),o=n.n(r),i=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function u(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},a=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=/https?\/((?:(?:2(?:[0-4][0-9]|5[0-5])|[0-1]?[0-9]?[0-9])\.){3}(?:(?:2([0-4][0-9]|5[0-5])|[0-1]?[0-9]?[0-9])))\//,s=function(){function t(){this.host="10.0.38.46",this.url=this.getUrl(),this.BYPASS_URL=window.location.protocol+"//"+this.url+"/archiver-generic-backend",this.GET_DATA_URL=window.location.protocol+"//"+this.url+"/retrieval/data/getData.json",this.APPLIANCES=[window.location.protocol+"//"+this.url,window.location.protocol+"//"+this.url+"/archiver-beamlines"]}return t.prototype.getRemoteDate=function(){return i(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,o.a.get(this.BYPASS_URL+"/date",{timeout:2e3}).then((function(t){if(200===t.status)return t.data;throw"Invalid response from date backend "+t.status+", "+t.data}))];case 1:return(t=e.sent())?[2,new Date(t)]:[2,null]}}))}))},t.prototype.fetchMetadata=function(t){return i(this,void 0,void 0,(function(){var e,n,r,i,u;return a(this,(function(a){switch(a.label){case 0:if(void 0===t)return[2,null];e=0,n=this.APPLIANCES,a.label=1;case 1:return e<n.length?(r=n[e],i=r+"/retrieval/bpl/getMetadata?pv="+t,[4,o.a.get(i,{timeout:0,responseType:"json"}).then((function(t){return 200!==t.status?null:t.data})).catch((function(t){return null}))]):[3,4];case 2:if(null!==(u=a.sent()))return[2,u];a.label=3;case 3:return e++,[3,1];case 4:return[2,null]}}))}))},t.prototype.setUrl=function(t){this.url=t},t.prototype.query=function(t){return i(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return 1e4,e=window.location.protocol+"//"+this.url+"/retrieval/bpl/getMatchingPVs?"+new URLSearchParams({pv:t,limit:"500"}).toString(),[4,o.a.get(e,{method:"GET",timeout:1e4,responseType:"json"}).then((function(t){if(200!==t.status)throw"Failed to complete request "+e+", response "+t;return t.data}))];case 1:return[2,n.sent()]}}))}))},t.prototype.parseData=function(t){var e=[];return t.forEach((function(t){var n,r=t.val,o=t.secs,i=t.nanos,a=t.severity,u=t.status;if(r instanceof Array){var s=r[0];r[1],r[2],r[3],r[4];n=s}else n=r;var l=new Date(1e3*o+1e-6*i);isNaN(l.getTime())||e.push({x:l,y:n,severity:a,status:u})})),e},t.prototype.fetchData=function(t,e,n,r,u){return i(this,void 0,void 0,(function(){var i,s;return a(this,(function(a){switch(a.label){case 0:return void 0===e||void 0===n?[2,null]:(void 0===r&&(r=!1),i=r?this.GET_DATA_URL+"?pv=optimized_"+u+"("+t+")&from="+e.toJSON()+"&to="+n.toJSON():this.GET_DATA_URL+"?pv="+t+"&from="+e.toJSON()+"&to="+n.toJSON(),[4,o.a.get(i,{timeout:0,method:"GET",responseType:"text",transformResponse:function(t){if(t.includes("Bad Request"))throw"Invalid response from "+i;var e=t.replace(/(-?Infinity)/g,'"$1"');return e=e.replace(/(NaN)/g,'"$1"'),e=JSON.parse(e)}}).then((function(t){if(200!==t.status)throw"Request "+i+" return invalid status code "+t;if(0===t.data.length)throw"Request returned an empty array, probably due to an invalid range for the url "+i;return t.data[0]}))]);case 1:return[2,{meta:(s=a.sent()).meta,data:this.parseData(s.data)}]}}))}))},t.prototype.getUrl=function(){if("vpn.cnpem.br"===window.location.host){var t=u.exec(window.location.href);t&&t.length>1&&(this.host=t[1])}else this.host=window.location.host;return"localhost:8080"!==window.location.host&&"127.0.0.1:8080"!==window.location.host||(this.host="10.0.38.46",console.log("DEBUG SERVER. Setting host to "+this.host)),this.host},t}(),l=function(){return new s}();e.default=l}});